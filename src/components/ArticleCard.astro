---
import SFIcon from "./SFIcon.astro";

interface Props {
  href: string;
  title: string;
  summary: string;
  dateISO: string;
  dateLabel: string;
  tags?: string[];
  featured?: boolean;
  revealGroup?: string;
  revealOrder?: number | string;
  revealDelay?: string;
  readingTimeMinutes?: number;
}

const {
  href,
  title,
  summary,
  dateISO,
  dateLabel,
  tags = [],
  featured = false,
  revealGroup = "articles",
  revealOrder,
  revealDelay,
  readingTimeMinutes,
}: Props = Astro.props;
const tagLabel = tags.join(" Â· ");
const revealOrderAttr =
  revealOrder === undefined || revealOrder === null ? undefined : String(revealOrder);
const readingTimeLabel =
  typeof readingTimeMinutes === "number" && Number.isFinite(readingTimeMinutes)
    ? `${Math.max(1, Math.round(readingTimeMinutes))} min read`
    : null;
---

<article
  class={`articleCard${featured ? " articleCard--featured" : ""}`}
  data-reveal
  data-reveal-group={revealGroup}
  data-reveal-order={revealOrderAttr}
  data-reveal-delay={revealDelay ?? undefined}
>
  <a class="articleCard__link" href={href}>
    <header class="articleCard__header">
      <div class="articleCard__meta" aria-label="Post metadata">
        <span class="articleCard__metaItem">
          <time datetime={dateISO}>{dateLabel}</time>
        </span>
        {
          readingTimeLabel && (
            <span class="articleCard__metaItem">{readingTimeLabel}</span>
          )
        }
        {
          tagLabel && (
            <span class="articleCard__metaItem articleCard__metaTags" aria-label="Tags">
              {tagLabel}
            </span>
          )
        }
      </div>
      <h3 class="articleCard__title">{title}</h3>
    </header>
    <p class="articleCard__summary">{summary}</p>
    {
      tags.length > 0 && (
        <ul class="articleCard__tags" aria-label="Tags">
          {tags.map((tag) => (
            <li class="articleCard__tag">{tag}</li>
          ))}
        </ul>
      )
    }
    <span class="articleCard__cta">
      <span>Read article</span>
      <SFIcon name="arrow-up-right" size={18} stroke={1.6} />
    </span>
  </a>
</article>
