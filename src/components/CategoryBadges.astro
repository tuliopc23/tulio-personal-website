---
import PhosphorIcon from "./PhosphorIcon.astro";
import type { Category } from "../sanity/lib/posts";

interface Props {
  categories?: Category[] | null;
  limit?: number;
}

const { categories = [], limit } = Astro.props;
const validCategories = Array.isArray(categories) ? categories : [];
const _displayCategories = limit ? validCategories.slice(0, limit) : validCategories;

// Map category slugs to icon names
const categoryIconMap: Record<string, string> = {
  "software-development": "code",
  development: "code",
  code: "code",
  design: "paint-brush",
  writing: "article",
  tutorial: "book-open",
  announcement: "sparkle",
  default: "folder",
};

const getCategoryIcon = (slug: string) => {
  return categoryIconMap[slug.toLowerCase()] || categoryIconMap.default;
};
---

{
  _displayCategories.length > 0 && (
    <div class="categoryBadges">
      {_displayCategories.map((category) => (
        <a href={`/blog/category/${category.slug}/`} class="categoryBadge">
          <PhosphorIcon name={getCategoryIcon(category.slug)} size={12} weight="bold" />
          <span>{category.title}</span>
        </a>
      ))}
    </div>
  )
}

<style>
  .categoryBadges {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  .categoryBadge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2xs);
    padding: var(--space-2xs) var(--space-sm);
    font-size: var(--fs--2);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--accent);
    background: var(--accent-surface);
    border: 1px solid var(--accent-hairline);
    border-radius: var(--radius-full);
    text-decoration: none;
    transition:
      color 0.2s ease,
      background 0.2s ease,
      border-color 0.2s ease;
  }

  .categoryBadge:hover {
    color: var(--accent-bright);
    background: var(--accent-surface-hover);
    border-color: var(--accent);
  }

  @media (prefers-reduced-motion: reduce) {
    .categoryBadge {
      transition: none;
    }

    .categoryBadge:hover {
      color: var(--accent-bright);
    }
  }
</style>
